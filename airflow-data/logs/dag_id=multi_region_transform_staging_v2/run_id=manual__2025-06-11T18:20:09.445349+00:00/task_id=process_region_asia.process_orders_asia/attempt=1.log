[2025-06-11T18:22:26.940+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: multi_region_transform_staging_v2.process_region_asia.process_orders_asia manual__2025-06-11T18:20:09.445349+00:00 [queued]>
[2025-06-11T18:22:26.963+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: multi_region_transform_staging_v2.process_region_asia.process_orders_asia manual__2025-06-11T18:20:09.445349+00:00 [queued]>
[2025-06-11T18:22:26.964+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-06-11T18:22:26.999+0000] {taskinstance.py:2191} INFO - Executing <Task(_PythonDecoratedOperator): process_region_asia.process_orders_asia> on 2025-06-11 18:20:09.445349+00:00
[2025-06-11T18:22:27.013+0000] {standard_task_runner.py:60} INFO - Started process 6341 to run task
[2025-06-11T18:22:27.020+0000] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'multi_region_transform_staging_v2', 'process_region_asia.process_orders_asia', 'manual__2025-06-11T18:20:09.445349+00:00', '--job-id', '624', '--raw', '--subdir', 'DAGS_FOLDER/master_dag.py', '--cfg-path', '/tmp/tmp_at83iri']
[2025-06-11T18:22:27.025+0000] {standard_task_runner.py:88} INFO - Job 624: Subtask process_region_asia.process_orders_asia
[2025-06-11T18:22:27.193+0000] {task_command.py:423} INFO - Running <TaskInstance: multi_region_transform_staging_v2.process_region_asia.process_orders_asia manual__2025-06-11T18:20:09.445349+00:00 [running]> on host 5950010ae7c1
[2025-06-11T18:22:27.505+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='data-team' AIRFLOW_CTX_DAG_ID='multi_region_transform_staging_v2' AIRFLOW_CTX_TASK_ID='process_region_asia.process_orders_asia' AIRFLOW_CTX_EXECUTION_DATE='2025-06-11T18:20:09.445349+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-11T18:20:09.445349+00:00'
[2025-06-11T18:22:40.131+0000] {logging_mixin.py:188} INFO - Debugggg::::Vector(spark://5950010ae7c1:36107/jars/spark-snowflake_2.12-2.16.0-spark_3.2.jar, spark://5950010ae7c1:36107/jars/snowflake-jdbc-3.13.17.jar)
[2025-06-11T18:22:40.133+0000] {logging_mixin.py:188} INFO - Processing orders for region asia
[2025-06-11T18:22:40.175+0000] {logging_mixin.py:188} INFO - /opt/airflow/data/raw/region=asia/table=orders/load_date=2025-06-11
[2025-06-11T18:23:09.789+0000] {logging_mixin.py:188} INFO - STAGING_ASIA
[2025-06-11T18:23:12.846+0000] {logging_mixin.py:188} INFO - +--------+---------------+-----------+------------+-------------------+------------------+------------------+-------------------+-------------------+------------------+------------------+-------------------+-----------+-----------+-------------------+-------+--------+
|order_id|order_reference|customer_id|order_status|    order_timestamp|      subtotal_usd|    tax_amount_usd|shipping_amount_usd|discount_amount_usd|  total_amount_usd|billing_address_id|shipping_address_id|campaign_id|discount_id|         created_at|_region| _source|
+--------+---------------+-----------+------------+-------------------+------------------+------------------+-------------------+-------------------+------------------+------------------+-------------------+-----------+-----------+-------------------+-------+--------+
|       1|  JP-ORD-100001|          1|   delivered|2024-03-05 13:30:25|           1018.64|101.86399999999999|                6.8| 101.86399999999999|           1025.44|                 1|                  2|          1|          1|2024-03-06 09:15:40|   asia|postgres|
|       2|  JP-ORD-100002|          2|     shipped|2024-03-06 00:00:00|60.519999999999996|             6.052| 5.4399999999999995|                0.0|            72.012|                 3|                  3|          2|       NULL|2024-03-07 00:00:00|   asia|postgres|
|       3|  JP-ORD-100003|          3|  processing|2024-03-07 00:00:00|1346.3999999999999|            134.64|                0.0| 336.59999999999997|1144.4399999999998|                 4|                  5|          3|          3|2024-03-08 00:00:00|   asia|postgres|
|       5|  JP-ORD-100005|          5|   cancelled|2024-09-03 00:00:00|             170.0|              17.0| 5.4399999999999995|                0.0|            192.44|                 7|                  7|          5|       NULL|2024-10-03 00:00:00|   asia|postgres|
|       6|  JP-ORD-100006|          6|   delivered|2024-03-10 15:15:20|             66.64|             6.664|                3.4|  9.995999999999999|            66.708|                 8|                  8|          6|          6|2024-03-11 10:15:35|   asia|postgres|
|       7|  JP-ORD-100007|          7|     shipped|2024-03-11 00:00:00| 605.1999999999999|60.519999999999996|               10.2| 151.29999999999998|            524.62|                 9|                  9|          7|          7|2024-03-12 00:00:00|   asia|postgres|
|       8|  JP-ORD-100008|          8|  processing|2024-03-12 00:00:00|30.599999999999998|3.0599999999999996| 5.4399999999999995|  6.119999999999999|             32.98|                10|                 10|          8|          8|2024-03-13 00:00:00|   asia|postgres|
|      10|  JP-ORD-100010|         10|    returned|2024-03-14 00:00:00|              85.0|               8.5|                3.4|                8.5| 88.39999999999999|                12|                 12|         10|          9|2024-03-15 00:00:00|   asia|postgres|
+--------+---------------+-----------+------------+-------------------+------------------+------------------+-------------------+-------------------+------------------+------------------+-------------------+-----------+-----------+-------------------+-------+--------+
[2025-06-11T18:23:12.847+0000] {logging_mixin.py:188} INFO - Inserting into snowflake
[2025-06-11T18:23:21.881+0000] {logging_mixin.py:188} INFO - successfully inserted in snowflake
[2025-06-11T18:23:21.891+0000] {crypto.py:82} WARNING - empty cryptography key - values will not be stored encrypted.
[2025-06-11T18:23:22.198+0000] {logging_mixin.py:188} INFO - Successfully processed 8 records for orders in asia
[2025-06-11T18:23:25.794+0000] {python.py:201} INFO - Done. Returned value was: {'region': 'asia', 'table': 'orders', 'record_count': 8, 'status': 'success'}
[2025-06-11T18:23:25.894+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=multi_region_transform_staging_v2, task_id=process_region_asia.process_orders_asia, execution_date=20250611T182009, start_date=20250611T182226, end_date=20250611T182325
[2025-06-11T18:23:26.026+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-06-11T18:23:26.124+0000] {taskinstance.py:3280} INFO - 3 downstream tasks scheduled from follow-on schedule check
