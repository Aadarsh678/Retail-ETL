[2025-06-08T19:25:59.292+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: extract_postgres_table_to_parquet.run_extraction_asia manual__2025-06-08T19:24:38.709631+00:00 [queued]>
[2025-06-08T19:25:59.317+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: extract_postgres_table_to_parquet.run_extraction_asia manual__2025-06-08T19:24:38.709631+00:00 [queued]>
[2025-06-08T19:25:59.319+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 1
[2025-06-08T19:25:59.352+0000] {taskinstance.py:2191} INFO - Executing <Task(_PythonDecoratedOperator): run_extraction_asia> on 2025-06-08 19:24:38.709631+00:00
[2025-06-08T19:25:59.361+0000] {standard_task_runner.py:60} INFO - Started process 18127 to run task
[2025-06-08T19:25:59.367+0000] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'extract_postgres_table_to_parquet', 'run_extraction_asia', 'manual__2025-06-08T19:24:38.709631+00:00', '--job-id', '5', '--raw', '--subdir', 'DAGS_FOLDER/asia/landing.py', '--cfg-path', '/tmp/tmphu16gcf9']
[2025-06-08T19:25:59.372+0000] {standard_task_runner.py:88} INFO - Job 5: Subtask run_extraction_asia
[2025-06-08T19:25:59.497+0000] {task_command.py:423} INFO - Running <TaskInstance: extract_postgres_table_to_parquet.run_extraction_asia manual__2025-06-08T19:24:38.709631+00:00 [running]> on host 098d7b977cb8
[2025-06-08T19:25:59.743+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='extract_postgres_table_to_parquet' AIRFLOW_CTX_TASK_ID='run_extraction_asia' AIRFLOW_CTX_EXECUTION_DATE='2025-06-08T19:24:38.709631+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-06-08T19:24:38.709631+00:00'
[2025-06-08T19:25:59.746+0000] {logging_mixin.py:188} INFO - Starting extraction for table: categories in region: asia
[2025-06-08T19:26:10.014+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.categories) AS full_data
[2025-06-08T19:26:24.379+0000] {logging_mixin.py:188} INFO - +------+--------------+---------+--------------------+-----------+-------------------+--------------------+-------+--------+
|cat_id|          name|parent_id|                path|active_flag|        create_time|         modify_time|_region| _source|
+------+--------------+---------+--------------------+-----------+-------------------+--------------------+-------+--------+
|     1|   Electronics|     NULL|        /Electronics|          Y|2024-01-01 09:00:00|2025-06-08 19:23:...|   asia|postgres|
|     2|   SMARTPHONES|        1|/Electronics/Smar...|          Y|2024/01/02 10:30:45|2025-06-08 19:23:...|   asia|postgres|
|     3|       laptops|        1|/Electronics/Laptops|          Y|01-03-2024 14:25:30|2025-06-08 19:23:...|   asia|postgres|
|     4|Gaming Devices|        1| /Electronics/Gaming|          Y|2024.01.04 16:15:00|2025-06-08 19:23:...|   asia|postgres|
|     5|      CLOTHING|     NULL|           /Clothing|          Y|05/01/2024 08:45:20|2025-06-08 19:23:...|   asia|postgres|
|     6|  mens fashion|        5|      /Clothing/Mens|          Y|         2024-01-06|2025-06-08 19:23:...|   asia|postgres|
|     7|WOMENS FASHION|        5|    /Clothing/Womens|          Y|         07/01/2024|2025-06-08 19:23:...|   asia|postgres|
|     8| Home & Living|     NULL|        /Home-Living|          Y|2024-01-08 11:20:15|2025-06-08 19:23:...|   asia|postgres|
|     9|     furniture|        8|/Home-Living/Furn...|          Y|         09-01-2024|2025-06-08 19:23:...|   asia|postgres|
|    10|         BOOKS|     NULL|              /Books|          Y|         2024/01/10|2025-06-08 19:23:...|   asia|postgres|
+------+--------------+---------+--------------------+-----------+-------------------+--------------------+-------+--------+
only showing top 10 rows
[2025-06-08T19:26:24.380+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=categories/load_date=2025-06-08/
[2025-06-08T19:26:27.688+0000] {logging_mixin.py:188} INFO - Finished extraction for categories
[2025-06-08T19:26:27.689+0000] {logging_mixin.py:188} INFO - Starting extraction for table: products in region: asia
[2025-06-08T19:26:28.200+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.products) AS full_data
[2025-06-08T19:26:29.770+0000] {logging_mixin.py:188} INFO - +----------+-----------+----------------+--------------------+------+---------+--------+--------+--------------------+-------------+-------------------+-------+--------+
|product_id|  item_code|            name|         description|cat_id|price_jpy|cost_jpy|weight_g|           size_info|active_status|        create_date|_region| _source|
+----------+-----------+----------------+--------------------+------+---------+--------+--------+--------------------+-------------+-------------------+-------+--------+
|         1|JP-ITEM-001|   iPhone 15 Pro|Latest Apple smar...|     2|   149800|   95000|   187.5|146.7mm x 71.5mm ...|       ACTIVE|2024-01-15 08:30:45|   asia|postgres|
|         2|JP-ITEM-002|  MACBOOK AIR M2|Apple MacBook Air...|     3|   158000|   98000|  1240.0|304.1mm x 215mm x...|       ACTIVE|2024/01/16 10:15:20|   asia|postgres|
|         3|JP-ITEM-003|   playstation 5|Sony PlayStation ...|     4|    59800|   42000|  4500.0|390mm x 260mm x 1...|       ACTIVE|17-01-2024 13:45:30|   asia|postgres|
|         4|JP-ITEM-004|  Cotton T-Shirt|Premium cotton t-...|     6|     3500|    1200|   180.0|       Various sizes|       ACTIVE|2024.01.18 15:20:10|   asia|postgres|
|         5|JP-ITEM-005|    SUMMER DRESS|Elegant summer dr...|     7|     8900|    3500|   300.0|       Various sizes|       ACTIVE|19/01/2024 09:40:25|   asia|postgres|
|         6|JP-ITEM-006|    leather sofa|Premium leather 3...|     9|   198000|   95000| 85000.0|2200mm x 900mm x ...|       ACTIVE|         2024-01-20|   asia|postgres|
|         7|JP-ITEM-007|MANGA COLLECTION|Complete manga se...|    10|    12500|    6000|  2500.0|180mm x 120mm x 2...|       ACTIVE|         21/01/2024|   asia|postgres|
|         8|JP-ITEM-008|    facial serum|Premium anti-agin...|    11|     9800|    3000|    50.0| 120mm x 40mm x 40mm|       ACTIVE|2024/01/22 11:30:15|   asia|postgres|
|         9|JP-ITEM-009|   MOUNTAIN BIKE|Professional moun...|    12|    89000|   45000| 12500.0|1700mm x 650mm x ...|       ACTIVE|23-01-2024 14:25:30|   asia|postgres|
|        10|JP-ITEM-010|gundam model kit|Detailed Gundam p...|    14|     4500|    2200|   350.0|300mm x 250mm x 1...|       ACTIVE|2024.01.24 16:50:20|   asia|postgres|
+----------+-----------+----------------+--------------------+------+---------+--------+--------+--------------------+-------------+-------------------+-------+--------+
only showing top 10 rows
[2025-06-08T19:26:29.772+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=products/load_date=2025-06-08/
[2025-06-08T19:26:31.189+0000] {logging_mixin.py:188} INFO - Finished extraction for products
[2025-06-08T19:26:31.190+0000] {logging_mixin.py:188} INFO - Starting extraction for table: product_variants in region: asia
[2025-06-08T19:26:32.010+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.product_variants) AS full_data
[2025-06-08T19:26:33.520+0000] {logging_mixin.py:188} INFO - +----------+----------+--------------------+--------------------+-------------+-------------+--------------+------+-------------------+-------+--------+
|variant_id|product_id|                 sku|        variant_name| variant_type|variant_value|price_diff_jpy|status|            created|_region| _source|
+----------+----------+--------------------+--------------------+-------------+-------------+--------------+------+-------------------+-------+--------+
|         1|         1|JP-ITEM-001-BLACK...|iPhone 15 Pro Bla...|color_storage|  Black 128GB|             0|ACTIVE|2024-02-01 08:30:00|   asia|postgres|
|         2|         1|JP-ITEM-001-BLUE-...|iPhone 15 Pro Blu...|color_storage|   Blue 256GB|         20000|ACTIVE|2024/02/01 09:45:15|   asia|postgres|
|         3|         1|JP-ITEM-001-WHITE...|iPhone 15 Pro Whi...|color_storage|  White 512GB|         40000|ACTIVE|01-02-2024 11:20:30|   asia|postgres|
|         4|         2|JP-ITEM-002-SILVE...|MacBook Air Silve...| color_memory|   Silver 8GB|             0|ACTIVE|2024.02.02 13:15:45|   asia|postgres|
|         5|         2|JP-ITEM-002-GOLD-...|MacBook Air Gold ...| color_memory|    Gold 16GB|         30000|ACTIVE|03/02/2024 15:40:10|   asia|postgres|
|         6|         3|JP-ITEM-003-STANDARD|PlayStation 5 Sta...|      edition|     Standard|             0|ACTIVE|         2024-02-04|   asia|postgres|
|         7|         3| JP-ITEM-003-DIGITAL|PlayStation 5 Dig...|      edition|      Digital|        -10000|ACTIVE|         05/02/2024|   asia|postgres|
|         8|         4|   JP-ITEM-004-RED-M|Cotton T-Shirt Re...|   color_size|        Red M|             0|ACTIVE|2024/02/06 10:25:30|   asia|postgres|
|         9|         4|  JP-ITEM-004-BLUE-L|Cotton T-Shirt Bl...|   color_size|       Blue L|           500|ACTIVE|07-02-2024 12:50:15|   asia|postgres|
|        10|         4|JP-ITEM-004-BLACK-XL|Cotton T-Shirt Bl...|   color_size|     Black XL|          1000|ACTIVE|2024.02.08 14:35:20|   asia|postgres|
+----------+----------+--------------------+--------------------+-------------+-------------+--------------+------+-------------------+-------+--------+
only showing top 10 rows
[2025-06-08T19:26:33.521+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=product_variants/load_date=2025-06-08/
[2025-06-08T19:26:34.978+0000] {logging_mixin.py:188} INFO - Finished extraction for product_variants
[2025-06-08T19:26:34.980+0000] {logging_mixin.py:188} INFO - Starting extraction for table: inventory in region: asia
[2025-06-08T19:26:35.910+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.inventory) AS full_data
[2025-06-08T19:26:37.518+0000] {logging_mixin.py:188} INFO - +------------+----------+----------+-------------+------------+-------------+-------------------+-------------------+-------+--------+
|inventory_id|variant_id| warehouse|qty_available|qty_reserved|reorder_point|       last_restock|            updated|_region| _source|
+------------+----------+----------+-------------+------------+-------------+-------------------+-------------------+-------+--------+
|           1|         1|  TOKYO-01|          120|          25|           40|2024-02-22 08:30:15|2024-02-22 08:30:15|   asia|postgres|
|           2|         2|  TOKYO-01|           80|          15|           30|2024/02/23 10:45:30|2024/02/23 10:45:30|   asia|postgres|
|           3|         3|  OSAKA-02|           60|          10|           20|24-02-2024 13:20:45|24-02-2024 13:20:45|   asia|postgres|
|           4|         4| NAGOYA-03|          180|          30|           50|2024.02.25 15:35:10|2024.02.25 15:35:10|   asia|postgres|
|           5|         5| NAGOYA-03|          140|          25|           45|26/02/2024 09:10:25|26/02/2024 09:10:25|   asia|postgres|
|           6|         6|  TOKYO-01|           90|          18|           35|2024-02-27 11:45:40|2024-02-27 11:45:40|   asia|postgres|
|           7|         7|FUKUOKA-04|           70|          12|           25|2024/02/28 14:30:15|2024/02/28 14:30:15|   asia|postgres|
|           8|         8|  OSAKA-02|          250|          45|           75|29-02-2024 16:15:30|29-02-2024 16:15:30|   asia|postgres|
|           9|         9|  TOKYO-01|          170|          30|           50|2024.03.01 08:40:45|2024.03.01 08:40:45|   asia|postgres|
|          10|        10| NAGOYA-03|          210|          40|           65|02/03/2024 10:25:20|02/03/2024 10:25:20|   asia|postgres|
+------------+----------+----------+-------------+------------+-------------+-------------------+-------------------+-------+--------+
only showing top 10 rows
[2025-06-08T19:26:37.520+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=inventory/load_date=2025-06-08/
[2025-06-08T19:26:38.833+0000] {logging_mixin.py:188} INFO - Finished extraction for inventory
[2025-06-08T19:26:38.834+0000] {logging_mixin.py:188} INFO - Starting extraction for table: customers in region: asia
[2025-06-08T19:26:39.542+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.customers) AS full_data
[2025-06-08T19:26:41.723+0000] {logging_mixin.py:188} INFO - +-------+--------------------+-------+---------+----------------+----------+------+-------------------+-------------------+-------+--------------+-------------------+-------+--------+
|cust_id|               email|  fname|    lname|           phone|birth_date|   sex|           reg_date|         login_time|segment|        source|            created|_region| _source|
+-------+--------------------+-------+---------+----------------+----------+------+-------------------+-------------------+-------+--------------+-------------------+-------+--------+
|      1|tanaka.yuki@email.jp|   YUKI|   TANAKA| +81-3-1234-5678|1985-04-12|     M|2024-01-15 09:30:45|2024-02-20 14:25:30|premium|       organic|2024-01-15 09:30:45|   asia|postgres|
|      2|sato.hanako@gmail...| hanako|     sato| +81-6-8765-4321|1990/07/22|     F|2024/01/16 11:45:20|2024/02/21 16:40:15|regular|  social_media|2024-01-16 11:45:20|   asia|postgres|
|      3|SUZUKI.TARO@YAHOO...|   Taro|   SUZUKI|+81-52-2345-6789|15-05-1982|  Male|17-01-2024 13:20:35|22-02-2024 09:15:40|    new|      referral|2024-01-17 13:20:35|   asia|postgres|
|      4|yamada.keiko@hotm...|  Keiko|   yamada|+81-92-3456-7890|1988.06.18|Female|2024.01.18 15:35:10|2024.02.23 11:30:25|regular|      paid_ads|2024-01-18 15:35:10|   asia|postgres|
|      5|WATANABE.AKIRA@OU...|  akira| WATANABE|+81-11-4567-8901|25/09/1975|     M|19/01/2024 08:50:25|24/02/2024 13:45:10|premium|email_campaign|2024-01-19 08:50:25|   asia|postgres|
|      6|    invalid.email.jp| Yumiko| Nakamura| +81-3-5678-9012|1992-01-30|     F|2024-01-20 10:15:40|2024-02-25 15:20:35|regular|       organic|2024-01-20 10:15:40|   asia|postgres|
|      7|   @missing-local.jp|HIROSHI|      ito| +81-6-6789-0123|1980/12/05|     M|2024/01/21 12:30:15|2024/02/26 08:40:50|    new|  social_media|2024-01-21 12:30:15|   asia|postgres|
|      8|no-at-symbol.gmai...|  ayumi|     KATO|+81-52-7890-1234|10-04-1987|Female|22-01-2024 14:45:30|27-02-2024 10:15:30|regular|      referral|2024-01-22 14:45:30|   asia|postgres|
|      9|    double@@email.jp|Takashi|    saito|+81-92-8901-2345|1983.08.14|  Male|2024.01.23 16:20:45|2024.02.28 12:30:45|premium|      paid_ads|2024-01-23 16:20:45|   asia|postgres|
|     10|  spaces in@email.jp| MIZUKI|KOBAYASHI|+81-11-9012-3456|03/06/1991|     F|24/01/2024 09:35:20|29/02/2024 14:55:20|regular|email_campaign|2024-01-24 09:35:20|   asia|postgres|
+-------+--------------------+-------+---------+----------------+----------+------+-------------------+-------------------+-------+--------------+-------------------+-------+--------+
only showing top 10 rows
[2025-06-08T19:26:41.726+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=customers/load_date=2025-06-08/
[2025-06-08T19:26:43.558+0000] {logging_mixin.py:188} INFO - Finished extraction for customers
[2025-06-08T19:26:43.559+0000] {logging_mixin.py:188} INFO - Starting extraction for table: customer_addresses in region: asia
[2025-06-08T19:26:44.256+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.customer_addresses) AS full_data
[2025-06-08T19:26:45.680+0000] {logging_mixin.py:188} INFO - +-------+-------+---------+-----------------+--------+----------+--------+-------+----------+--------------------+-------+--------+
|addr_id|cust_id|addr_type|           street|    city|prefecture|  postal|country|is_default|             created|_region| _source|
+-------+-------+---------+-----------------+--------+----------+--------+-------+----------+--------------------+-------+--------+
|      1|      1|  billing|    1-2-3 Chiyoda|   Tokyo|     Tokyo|100-0001|  Japan|         Y|2025-06-08 19:23:...|   asia|postgres|
|      2|      1| shipping|     4-5-6 Minato|   Tokyo|     Tokyo|105-0001|  Japan|         N|2025-06-08 19:23:...|   asia|postgres|
|      3|      2|  billing|     7-8-9 Naniwa|   Osaka|     Osaka|556-0001|  Japan|         Y|2025-06-08 19:23:...|   asia|postgres|
|      4|      3|  billing|10-11-12 Nakamura|  Nagoya|     Aichi|450-0001|  Japan|         Y|2025-06-08 19:23:...|   asia|postgres|
|      5|      3| shipping| 13-14-15 Higashi|  Nagoya|     Aichi|461-0001|  Japan|         N|2025-06-08 19:23:...|   asia|postgres|
|      6|      4|  billing|  16-17-18 Hakata| Fukuoka|   Fukuoka|812-0011|  Japan|         Y|2025-06-08 19:23:...|   asia|postgres|
|      7|      5|  billing|    19-20-21 Chuo| Sapporo|  Hokkaido|060-0001|  Japan|         Y|2025-06-08 19:23:...|   asia|postgres|
|      8|      6|  billing|    22-23-24 Aoba|Yokohama|  Kanagawa|225-0001|  Japan|         Y|2025-06-08 19:23:...|   asia|postgres|
|      9|      7|  billing|   25-26-27 Nishi|    Kobe|     Hyogo|651-0001|  Japan|         Y|2025-06-08 19:23:...|   asia|postgres|
|     10|      8|  billing|    28-29-30 Kita|   Kyoto|     Kyoto|603-8001|  Japan|         Y|2025-06-08 19:23:...|   asia|postgres|
+-------+-------+---------+-----------------+--------+----------+--------+-------+----------+--------------------+-------+--------+
only showing top 10 rows
[2025-06-08T19:26:45.681+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=customer_addresses/load_date=2025-06-08/
[2025-06-08T19:26:46.729+0000] {logging_mixin.py:188} INFO - Finished extraction for customer_addresses
[2025-06-08T19:26:46.731+0000] {logging_mixin.py:188} INFO - Starting extraction for table: marketing_campaigns in region: asia
[2025-06-08T19:26:47.696+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.marketing_campaigns) AS full_data
[2025-06-08T19:26:48.812+0000] {logging_mixin.py:188} INFO - +-----------+--------------------+--------------+-------------+----------+----------+----------+--------------------+---------+-------------------+-------+--------+
|campaign_id|                name|          type|      channel|  start_dt|    end_dt|budget_jpy|              target|   status|            created|_region| _source|
+-----------+--------------------+--------------+-------------+----------+----------+----------+--------------------+---------+-------------------+-------+--------+
|          1|SPRING FESTIVAL SALE|      seasonal|        email|2024-03-01|2024-03-31|   1500000|All customers nat...|   active|2024-02-15 09:30:45|   asia|postgres|
|          2| golden week special|   promotional|       social|2024/04/27|2024/05/06|   2500000|Families and trav...|scheduled|2024/02/16 11:45:20|   asia|postgres|
|          3|    Summer Clearance|      seasonal|      display|01-06-2024|30-06-2024|   1200000|  Young adults 18-35|scheduled|17-02-2024 13:20:35|   asia|postgres|
|          4|BACK TO SCHOOL CA...|      seasonal|multi_channel|2024.07.15|2024.08.31|   1800000|Students and parents|scheduled|2024.02.18 15:35:10|   asia|postgres|
|          5|autumn fashion co...|product_launch|       social|01/09/2024|30/09/2024|   2000000|Fashion-conscious...|scheduled|19/02/2024 08:50:25|   asia|postgres|
|          6| Winter Holiday Sale|      seasonal|        email|2024-12-01|2024-12-25|   3000000|Gift buyers and f...|scheduled|2024-02-20 10:15:40|   asia|postgres|
|          7|   NEW YEAR CAMPAIGN|   promotional|multi_channel|2024/12/26|2025/01/15|   2800000|All customer segm...|scheduled|2024/02/21 12:30:15|   asia|postgres|
|          8|   valentine special|      seasonal|       social|01-02-2025|14-02-2025|   1000000|Couples and gift ...|scheduled|22-02-2024 14:45:30|   asia|postgres|
|          9|  Spring Electronics|product_launch|      display|2025.03.01|2025.03.31|   1500000|    Tech enthusiasts|scheduled|2024.02.23 16:20:45|   asia|postgres|
|         10|CHERRY BLOSSOM FE...|      seasonal|multi_channel|25/03/2025|15/04/2025|   2200000| Tourists and locals|scheduled|24/02/2024 09:35:20|   asia|postgres|
+-----------+--------------------+--------------+-------------+----------+----------+----------+--------------------+---------+-------------------+-------+--------+
[2025-06-08T19:26:48.816+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=marketing_campaigns/load_date=2025-06-08/
[2025-06-08T19:26:49.625+0000] {logging_mixin.py:188} INFO - Finished extraction for marketing_campaigns
[2025-06-08T19:26:49.626+0000] {logging_mixin.py:188} INFO - Starting extraction for table: discounts in region: asia
[2025-06-08T19:26:50.343+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.discounts) AS full_data
[2025-06-08T19:26:51.493+0000] {logging_mixin.py:188} INFO - +-----------+----------+--------------------+----------+-------+-------------+----------------+-----------+-----------+----------+----------+------+-------------------+-------+--------+
|discount_id|      code|                name|      type|  value|min_order_jpy|max_discount_jpy|usage_limit|usage_count|  start_dt|    end_dt|active|            created|_region| _source|
+-----------+----------+--------------------+----------+-------+-------------+----------------+-----------+-----------+----------+----------+------+-------------------+-------+--------+
|          1| WELCOME10|New Customer Welcome|percentage|  10.00|         5000|           10000|       1000|        234|2024-01-01|2024-12-31|     Y|2024-02-25 11:50:35|   asia|postgres|
|          2|  SPRING25| Spring Sale 25% Off|percentage|  25.00|        10000|           20000|        500|        156|2024/03/01|2024/03/31|     N|2024/02/26 14:15:10|   asia|postgres|
|          3|  FREESHIP|       Free Shipping|  shipping|   0.00|         8000|            1500|       2000|        567|01-03-2024|31-12-2024|     Y|27-02-2024 16:30:25|   asia|postgres|
|          4|  SAVE5000|       Save 5000 Yen|     fixed|5000.00|        20000|            5000|        300|         89|2024.02.01|2024.02.29|     N|2024.02.28 08:45:40|   asia|postgres|
|          5|BLACKFRI30|Black Friday 30% Off|percentage|  30.00|        15000|           30000|       1000|        678|25/11/2024|29/11/2024|     N|29/02/2024 10:20:15|   asia|postgres|
|          6| STUDENT15|    Student Discount|percentage|  15.00|         3000|           15000|          0|        123|2024-01-01|2024-12-31|     Y|2024-03-01 12:35:30|   asia|postgres|
|          7|   LOYAL25|Loyalty Member 25...|percentage|  25.00|        10000|           25000|        500|        234|2024/01/01|2024/12/31|     Y|2024/03/02 14:50:45|   asia|postgres|
|          8|  SUMMER20|      Summer Special|percentage|  20.00|         8000|           12000|        750|        345|01-06-2024|31-08-2024|     Y|03-03-2024 16:25:20|   asia|postgres|
|          9|  FIRST100| First 100 Customers|     fixed|2500.00|        10000|            2500|        100|        100|2024.01.01|2024.01.31|     N|2024.03.04 09:40:35|   asia|postgres|
|         10| WEEKEND10|     Weekend Special|percentage|  10.00|         6000|            8000|          0|        456|01/01/2024|31/12/2024|     Y|05/03/2024 11:15:10|   asia|postgres|
+-----------+----------+--------------------+----------+-------+-------------+----------------+-----------+-----------+----------+----------+------+-------------------+-------+--------+
[2025-06-08T19:26:51.494+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=discounts/load_date=2025-06-08/
[2025-06-08T19:26:52.290+0000] {logging_mixin.py:188} INFO - Finished extraction for discounts
[2025-06-08T19:26:52.290+0000] {logging_mixin.py:188} INFO - Starting extraction for table: shopping_carts in region: asia
[2025-06-08T19:26:52.767+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.shopping_carts) AS full_data
[2025-06-08T19:26:53.508+0000] {logging_mixin.py:188} INFO - +-------+-------+--------------------+-------------------+-------------------+-------------------+-------+--------+
|cart_id|cust_id|          session_id|            created|            updated|          abandoned|_region| _source|
+-------+-------+--------------------+-------------------+-------------------+-------------------+-------+--------+
|      1|      1|sess_jp_abc123def456|2024-03-15 09:30:45|2024-03-15 10:45:20|               NULL|   asia|postgres|
|      2|      2|sess_jp_ghi789jkl012|2024/03/16 11:15:35|2024/03/16 11:30:10|2024/03/16 12:45:25|   asia|postgres|
|      3|      3|sess_jp_mno345pqr678|17-03-2024 13:20:50|17-03-2024 14:35:15|               NULL|   asia|postgres|
|      4|      4|sess_jp_stu901vwx234|2024.03.18 15:40:30|2024.03.18 16:15:45|2024.03.18 17:30:20|   asia|postgres|
|      5|      5|sess_jp_yza567bcd890|19/03/2024 08:45:15|19/03/2024 09:20:30|               NULL|   asia|postgres|
+-------+-------+--------------------+-------------------+-------------------+-------------------+-------+--------+
[2025-06-08T19:26:53.510+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=shopping_carts/load_date=2025-06-08/
[2025-06-08T19:26:54.241+0000] {logging_mixin.py:188} INFO - Finished extraction for shopping_carts
[2025-06-08T19:26:54.241+0000] {logging_mixin.py:188} INFO - Starting extraction for table: cart_items in region: asia
[2025-06-08T19:26:54.667+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.cart_items) AS full_data
[2025-06-08T19:26:55.616+0000] {logging_mixin.py:188} INFO - +------------+-------+----------+---+--------------+-------------------+-------------------+-------+--------+
|cart_item_id|cart_id|variant_id|qty|unit_price_jpy|              added|            updated|_region| _source|
+------------+-------+----------+---+--------------+-------------------+-------------------+-------+--------+
|           1|      1|         2|  1|        169800|2024-03-15 09:35:20|2024-03-15 09:35:20|   asia|postgres|
|           2|      1|         8|  2|          3500|2024-03-15 09:40:35|2024-03-15 09:40:35|   asia|postgres|
|           3|      2|        15|  1|        213000|2024-03-16 11:20:10|2024-03-16 11:20:10|   asia|postgres|
|           4|      3|        19|  1|         12800|2024-03-17 13:25:45|2024-03-17 13:25:45|   asia|postgres|
|           5|      4|         6|  1|         49800|2024-03-18 15:45:30|2024-03-18 15:45:30|   asia|postgres|
|           6|      5|        12|  1|          8900|2024-03-19 08:50:15|2024-03-19 08:50:15|   asia|postgres|
+------------+-------+----------+---+--------------+-------------------+-------------------+-------+--------+
[2025-06-08T19:26:55.616+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=cart_items/load_date=2025-06-08/
[2025-06-08T19:26:56.623+0000] {logging_mixin.py:188} INFO - Finished extraction for cart_items
[2025-06-08T19:26:56.623+0000] {logging_mixin.py:188} INFO - Starting extraction for table: orders in region: asia
[2025-06-08T19:26:57.345+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.orders) AS full_data
[2025-06-08T19:26:58.170+0000] {logging_mixin.py:188} INFO - +--------+-------------+-------+----------+-------------------+------------+-------+------------+------------+---------+---------------+----------------+-----------+-----------+-------------------+-------+--------+
|order_id|     order_no|cust_id|    status|         order_time|subtotal_jpy|tax_jpy|shipping_jpy|discount_jpy|total_jpy|billing_addr_id|shipping_addr_id|campaign_id|discount_id|     processed_date|_region| _source|
+--------+-------------+-------+----------+-------------------+------------+-------+------------+------------+---------+---------------+----------------+-----------+-----------+-------------------+-------+--------+
|       1|JP-ORD-100001|      1| delivered|2024-03-05 13:30:25|      149800|  14980|        1000|       14980|   150800|              1|               2|          1|          1|2024-03-06 09:15:40|   asia|postgres|
|       2|JP-ORD-100002|      2|   shipped|2024/03/06 15:45:40|        8900|    890|         800|           0|    10590|              3|               3|          2|       NULL|2024/03/07 11:30:15|   asia|postgres|
|       3|JP-ORD-100003|      3|processing|07-03-2024 08:20:15|      198000|  19800|           0|       49500|   168300|              4|               5|          3|          3|08-03-2024 13:45:30|   asia|postgres|
|       4|JP-ORD-100004|      4| delivered|2024.03.08 10:35:30|       19800|   1980|        1000|        4950|    17830|              6|               6|          4|          4|2024.03.09 15:20:45|   asia|postgres|
|       5|JP-ORD-100005|      5| cancelled|09/03/2024 12:50:45|       25000|   2500|         800|           0|    28300|              7|               7|          5|       NULL|10/03/2024 08:40:20|   asia|postgres|
|       6|JP-ORD-100006|      6| delivered|2024-03-10 15:15:20|        9800|    980|         500|        1470|     9810|              8|               8|          6|          6|2024-03-11 10:15:35|   asia|postgres|
|       7|JP-ORD-100007|      7|   shipped|2024/03/11 08:30:35|       89000|   8900|        1500|       22250|    77150|              9|               9|          7|          7|2024/03/12 12:30:50|   asia|postgres|
|       8|JP-ORD-100008|      8|processing|12-03-2024 10:45:50|        4500|    450|         800|         900|     4850|             10|              10|          8|          8|13-03-2024 14:45:15|   asia|postgres|
|       9|JP-ORD-100009|      9| delivered|2024.03.13 13:10:15|      158000|  15800|           0|           0|   173800|             11|              11|          9|       NULL|2024.03.14 16:20:30|   asia|postgres|
|      10|JP-ORD-100010|     10|  returned|14/03/2024 15:25:30|       12500|   1250|         500|        1250|    13000|             12|              12|         10|          9|15/03/2024 09:35:45|   asia|postgres|
+--------+-------------+-------+----------+-------------------+------------+-------+------------+------------+---------+---------------+----------------+-----------+-----------+-------------------+-------+--------+
[2025-06-08T19:26:58.170+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=orders/load_date=2025-06-08/
[2025-06-08T19:26:59.316+0000] {logging_mixin.py:188} INFO - Finished extraction for orders
[2025-06-08T19:26:59.317+0000] {logging_mixin.py:188} INFO - Starting extraction for table: order_items in region: asia
[2025-06-08T19:26:59.897+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.order_items) AS full_data
[2025-06-08T19:27:00.423+0000] {logging_mixin.py:188} INFO - +-------------+--------+----------+---+--------------+---------------+-------------------+-------+--------+
|order_item_id|order_id|variant_id|qty|unit_price_jpy|total_price_jpy|            created|_region| _source|
+-------------+--------+----------+---+--------------+---------------+-------------------+-------+--------+
|            1|       1|         1|  1|        149800|         149800|2024-03-05 13:35:40|   asia|postgres|
|            2|       2|        11|  1|          8900|           8900|2024-03-06 15:50:25|   asia|postgres|
|            3|       3|        14|  1|        198000|         198000|2024-03-07 08:25:30|   asia|postgres|
|            4|       4|        14|  1|         19800|          19800|2024-03-08 10:40:45|   asia|postgres|
|            5|       5|        11|  1|         25000|          25000|2024-03-09 12:55:20|   asia|postgres|
|            6|       6|        18|  1|          9800|           9800|2024-03-10 15:20:35|   asia|postgres|
|            7|       7|        20|  1|         89000|          89000|2024-03-11 08:35:50|   asia|postgres|
|            8|       8|        10|  1|          4500|           4500|2024-03-12 10:50:15|   asia|postgres|
|            9|       9|         4|  1|        158000|         158000|2024-03-13 13:15:30|   asia|postgres|
|           10|      10|        16|  1|         12500|          12500|2024-03-14 15:30:45|   asia|postgres|
+-------------+--------+----------+---+--------------+---------------+-------------------+-------+--------+
[2025-06-08T19:27:00.424+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=order_items/load_date=2025-06-08/
[2025-06-08T19:27:01.362+0000] {logging_mixin.py:188} INFO - Finished extraction for order_items
[2025-06-08T19:27:01.364+0000] {logging_mixin.py:188} INFO - Starting extraction for table: shipments in region: asia
[2025-06-08T19:27:02.098+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.shipments) AS full_data
[2025-06-08T19:27:02.600+0000] {logging_mixin.py:188} INFO - +-----------+--------+--------------+----------+--------+-------------------+------------+-------------------+----------+-------------------+-------------------+-------+--------+
|shipment_id|order_id|   tracking_no|   carrier|  method|       shipped_time|est_delivery|    actual_delivery|    status|            created|            updated|_region| _source|
+-----------+--------+--------------+----------+--------+-------------------+------------+-------------------+----------+-------------------+-------------------+-------+--------+
|          1|       1|YMT123456789JP|    Yamato|Standard|2024-03-06 10:30:45|  2024-03-08|2024-03-08 14:15:30| delivered|2024-03-06 10:30:45|2024-03-08 14:15:30|   asia|postgres|
|          2|       2|SGW987654321JP|    Sagawa| Express|2024/03/07 12:45:20|  2024/03/09|               NULL|in_transit|2024/03/07 12:45:20|2024/03/07 12:45:20|   asia|postgres|
|          3|       3|          NULL|Japan Post|Standard|               NULL|        NULL|               NULL| preparing|07-03-2024 15:20:35|07-03-2024 15:20:35|   asia|postgres|
|          4|       4|YMT456789012JP|    Yamato|Next Day|2024.03.09 09:35:50|  2024.03.10|2024.03.10 13:50:15| delivered|2024.03.09 09:35:50|2024.03.10 13:50:15|   asia|postgres|
|          5|       6|SGW234567890JP|    Sagawa|Same Day|10/03/2024 11:15:30|  10/03/2024|10/03/2024 17:30:45| delivered|10/03/2024 11:15:30|10/03/2024 17:30:45|   asia|postgres|
|          6|       7|YMT345678901JP|    Yamato|Standard|2024-03-12 13:40:15|  2024-03-14|               NULL|in_transit|2024-03-12 13:40:15|2024-03-12 13:40:15|   asia|postgres|
|          7|       8|SGW456789012JP|    Sagawa| Express|2024/03/13 15:55:30|  2024/03/15|               NULL|in_transit|2024/03/13 15:55:30|2024/03/13 15:55:30|   asia|postgres|
|          8|       9|YMT567890123JP|    Yamato|Standard|14-03-2024 09:10:45|  16-03-2024|16-03-2024 11:25:30| delivered|14-03-2024 09:10:45|16-03-2024 11:25:30|   asia|postgres|
+-----------+--------+--------------+----------+--------+-------------------+------------+-------------------+----------+-------------------+-------------------+-------+--------+
[2025-06-08T19:27:02.602+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=shipments/load_date=2025-06-08/
[2025-06-08T19:27:03.608+0000] {logging_mixin.py:188} INFO - Finished extraction for shipments
[2025-06-08T19:27:03.615+0000] {logging_mixin.py:188} INFO - Starting extraction for table: returns in region: asia
[2025-06-08T19:27:04.581+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.returns) AS full_data
[2025-06-08T19:27:05.282+0000] {logging_mixin.py:188} INFO - +---------+--------+-----------------+----------+-------------------+----------+-------------------+-------------------+-------+--------+
|return_id|order_id|           reason|    status|        return_time|refund_jpy|        refund_time|            created|_region| _source|
+---------+--------+-----------------+----------+-------------------+----------+-------------------+-------------------+-------+--------+
|        1|       5|     Changed mind|  approved|2024-03-11 10:30:45|     28300|2024-03-12 14:15:30|2024-03-11 10:30:45|   asia|postgres|
|        2|      10|Product defective|processing|2024/03/16 12:45:20|     13000|               NULL|2024/03/16 12:45:20|   asia|postgres|
+---------+--------+-----------------+----------+-------------------+----------+-------------------+-------------------+-------+--------+
[2025-06-08T19:27:05.283+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=returns/load_date=2025-06-08/
[2025-06-08T19:27:06.023+0000] {logging_mixin.py:188} INFO - Finished extraction for returns
[2025-06-08T19:27:06.024+0000] {logging_mixin.py:188} INFO - Starting extraction for table: product_reviews in region: asia
[2025-06-08T19:27:06.671+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.product_reviews) AS full_data
[2025-06-08T19:27:07.112+0000] {logging_mixin.py:188} INFO - +---------+----------+-------+--------+------+------------------+--------------------+--------+-------------+--------------------+-------+--------+
|review_id|product_id|cust_id|order_id|rating|             title|         review_text|verified|helpful_count|             created|_region| _source|
+---------+----------+-------+--------+------+------------------+--------------------+--------+-------------+--------------------+-------+--------+
|        1|         1|      1|       1|     5|  EXCELLENT PHONE!|Amazing camera qu...|       Y|           15|2025-06-08 19:23:...|   asia|postgres|
|        2|         5|      2|       2|     4|   beautiful dress|Nice fabric and f...|       Y|            8|2025-06-08 19:23:...|   asia|postgres|
|        3|         6|      3|       3|     5|      Perfect Sofa|Comfortable and w...|       Y|           22|2025-06-08 19:23:...|   asia|postgres|
|        4|        14|      4|       4|     3|   AVERAGE EARBUDS|Sound quality is ...|       Y|            5|2025-06-08 19:23:...|   asia|postgres|
|        5|         7|     10|      10|     1|poor quality manga|Pages were damage...|       Y|            2|2025-06-08 19:23:...|   asia|postgres|
|        6|         1|      5|    NULL|     4|Good but expensive|Great phone but o...|       N|            3|2025-06-08 19:23:...|   asia|postgres|
|        7|         9|      7|       7|     5|     AMAZING BIKE!|Perfect for mount...|       Y|           18|2025-06-08 19:23:...|   asia|postgres|
|        8|        10|      8|       8|     4|     fun model kit|Great detail but ...|       Y|            7|2025-06-08 19:23:...|   asia|postgres|
+---------+----------+-------+--------+------+------------------+--------------------+--------+-------------+--------------------+-------+--------+
[2025-06-08T19:27:07.112+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=product_reviews/load_date=2025-06-08/
[2025-06-08T19:27:07.645+0000] {logging_mixin.py:188} INFO - Finished extraction for product_reviews
[2025-06-08T19:27:07.646+0000] {logging_mixin.py:188} INFO - Starting extraction for table: payments in region: asia
[2025-06-08T19:27:08.218+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.payments) AS full_data
[2025-06-08T19:27:08.766+0000] {logging_mixin.py:188} INFO - +----------+--------+-------------+---------+----------+-------------------+---------------+--------------------+-------------------+-------+--------+
|payment_id|order_id|       method|   status|amount_jpy|       payment_time|transaction_ref|        gateway_resp|            created|_region| _source|
+----------+--------+-------------+---------+----------+-------------------+---------------+--------------------+-------------------+-------+--------+
|         1|       1|  credit_card|completed|    150800|2024-03-05 14:15:30|  txn_jp_cc_001|  Payment successful|2024-03-05 14:15:30|   asia|postgres|
|         2|       2|      konbini|completed|     10590|2024/03/06 16:30:45|  txn_jp_kb_002|Payment received ...|2024/03/06 16:30:45|   asia|postgres|
|         3|       3|bank_transfer|  pending|    168300|07-03-2024 09:45:20|  txn_jp_bt_003|Awaiting bank con...|07-03-2024 09:45:20|   asia|postgres|
|         4|       4|  credit_card|completed|     17830|2024.03.08 11:20:35|  txn_jp_cc_004|  Payment successful|2024.03.08 11:20:35|   asia|postgres|
|         5|       5|  credit_card|   failed|     28300|09/03/2024 13:35:50|  txn_jp_cc_005|       Card declined|09/03/2024 13:35:50|   asia|postgres|
|         6|       6|      konbini|completed|      9810|2024-03-10 16:50:15|  txn_jp_kb_006|Payment received ...|2024-03-10 16:50:15|   asia|postgres|
|         7|       7|  credit_card|completed|     77150|2024/03/11 09:15:30|  txn_jp_cc_007|  Payment successful|2024/03/11 09:15:30|   asia|postgres|
|         8|       8|bank_transfer|completed|      4850|12-03-2024 11:30:45|  txn_jp_bt_008|  Transfer confirmed|12-03-2024 11:30:45|   asia|postgres|
|         9|       9|  credit_card|completed|    173800|2024.03.13 14:45:20|  txn_jp_cc_009|  Payment successful|2024.03.13 14:45:20|   asia|postgres|
|        10|      10|      konbini| refunded|     13000|14/03/2024 16:20:35|  txn_jp_kb_010|    Payment refunded|14/03/2024 16:20:35|   asia|postgres|
+----------+--------+-------------+---------+----------+-------------------+---------------+--------------------+-------------------+-------+--------+
[2025-06-08T19:27:08.767+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=payments/load_date=2025-06-08/
[2025-06-08T19:27:09.667+0000] {logging_mixin.py:188} INFO - Finished extraction for payments
[2025-06-08T19:27:09.667+0000] {logging_mixin.py:188} INFO - Starting extraction for table: wishlists in region: asia
[2025-06-08T19:27:10.419+0000] {logging_mixin.py:188} INFO - (SELECT * FROM asia.wishlists) AS full_data
[2025-06-08T19:27:10.890+0000] {logging_mixin.py:188} INFO - +-----------+-------+----------+-------------------+-------+--------+
|wishlist_id|cust_id|product_id|              added|_region| _source|
+-----------+-------+----------+-------------------+-------+--------+
|          1|      1|         2|2024-03-17 09:30:45|   asia|postgres|
|          2|      1|         9|2024-03-17 09:35:20|   asia|postgres|
|          3|      1|        11|2024-03-17 09:40:15|   asia|postgres|
|          4|      2|         1|2024/03/18 11:15:30|   asia|postgres|
|          5|      2|         6|2024/03/18 11:20:45|   asia|postgres|
|          6|      2|         8|2024/03/18 11:25:10|   asia|postgres|
|          7|      3|         4|19-03-2024 13:40:25|   asia|postgres|
|          8|      3|         7|19-03-2024 13:45:40|   asia|postgres|
|          9|      3|        12|19-03-2024 13:50:15|   asia|postgres|
|         10|      4|         3|2024.03.20 15:25:30|   asia|postgres|
+-----------+-------+----------+-------------------+-------+--------+
only showing top 10 rows
[2025-06-08T19:27:10.890+0000] {logging_mixin.py:188} INFO - Writing data to /opt/airflow/data/raw/region=asia/table=wishlists/load_date=2025-06-08/
[2025-06-08T19:27:11.365+0000] {logging_mixin.py:188} INFO - Finished extraction for wishlists
[2025-06-08T19:27:11.366+0000] {python.py:201} INFO - Done. Returned value was: None
[2025-06-08T19:27:11.415+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=extract_postgres_table_to_parquet, task_id=run_extraction_asia, execution_date=20250608T192438, start_date=20250608T192559, end_date=20250608T192711
[2025-06-08T19:27:11.494+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-06-08T19:27:11.552+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
